<div class="container mt-4 mb-5 animate__animated animate__fadeIn">

  <button class="btn btn-link text-decoration-none text-muted mb-3 ps-0" (click)="goBack()">
    <i class="bi bi-arrow-left me-1"></i> Back
  </button>

  <div *ngIf="isLoading" class="text-center py-5">
    <div class="spinner-border text-primary" role="status"></div>
  </div>

  <!-- Conference Details View -->
  <div *ngIf="!isLoading && isConference && conference" class="row">
    <div class="col-lg-8">
      <div class="card border-0 shadow-sm">
        <div class="card-body p-4">
          <div class="d-flex justify-content-between align-items-start mb-3">
            <div>
              <h2 class="fw-bold mb-2">{{ conference.name }}</h2>
              <span class="badge" [ngClass]="{'bg-success': conference.status === 'Upcoming', 'bg-warning text-dark': conference.status === 'Ongoing', 'bg-secondary': conference.status === 'Past'}">
                {{ conference.status || 'Upcoming' }}
              </span>
            </div>
            <div>
              <!-- Author Actions -->
              <button *ngIf="isAuthor()" class="btn btn-success me-2" (click)="joinConference()">
                <i class="bi bi-plus-circle me-2"></i>Join Conference
              </button>

              <!-- Admin Actions -->
              <div *ngIf="isAdmin()">
                <button class="btn btn-warning me-2" (click)="editConference()">
                  <i class="bi bi-pencil me-2"></i>Edit
                </button>
                <button class="btn btn-danger" (click)="deleteConference()">
                  <i class="bi bi-trash me-2"></i>Delete
                </button>
              </div>
            </div>
          </div>

          <div class="mb-4">
            <h5 class="fw-semibold mb-3">Description</h5>
            <p class="text-muted">{{ conference.description }}</p>
          </div>

          <div class="row mb-4">
            <div class="col-md-6">
              <h6 class="fw-semibold mb-2">
                <i class="bi bi-calendar-event me-2"></i>Date
              </h6>
              <p class="text-muted">{{ conference.date }}</p>
            </div>
            <div class="col-md-6">
              <h6 class="fw-semibold mb-2">
                <i class="bi bi-geo-alt me-2"></i>Location
              </h6>
              <p class="text-muted">{{ conference.location }}</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-lg-4">
      <div class="card border-0 shadow-sm mb-3">
        <div class="card-body">
          <h5 class="fw-semibold mb-3">Quick Actions</h5>

          <!-- Author Quick Actions -->
          <div *ngIf="isAuthor()" class="d-grid gap-2">
            <button class="btn btn-outline-primary">
              <i class="bi bi-file-earmark-text me-2"></i>Submit Paper
            </button>
            <button class="btn btn-outline-secondary">
              <i class="bi bi-info-circle me-2"></i>View Guidelines
            </button>
          </div>

          <!-- Reviewer Quick Actions -->
          <div *ngIf="isReviewer()" class="d-grid gap-2">
            <button class="btn btn-outline-primary">
              <i class="bi bi-journal-text me-2"></i>View Papers
            </button>
            <button class="btn btn-outline-secondary">
              <i class="bi bi-clipboard-check me-2"></i>Review History
            </button>
          </div>

          <!-- Admin Quick Actions -->
          <div *ngIf="isAdmin()" class="d-grid gap-2">
            <button class="btn btn-outline-primary">
              <i class="bi bi-people me-2"></i>Manage Participants
            </button>
            <button class="btn btn-outline-secondary">
              <i class="bi bi-tags me-2"></i>Manage Tracks
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Paper Details View -->
  <div *ngIf="!isLoading && !isConference && paper" class="row">
    <div class="col-lg-8 mb-4">
      <div class="card border-0 shadow-sm h-100 rounded-4">
        <div class="card-body p-4">

          <div class="d-flex justify-content-between align-items-start mb-3">
            <span class="badge bg-light text-dark border">Paper ID: {{ paper.id }}</span>
            <span class="text-muted small">Submitted: {{ paper.submittedAt | date:'medium' }}</span>
          </div>

          <h3 class="fw-bold text-dark mb-4">{{ paper.title }}</h3>

          <h6 class="text-uppercase text-muted small fw-bold ls-1 mb-3">Abstract</h6>
          <div class="p-3 bg-light rounded-3 mb-4 border-start border-4 border-primary">
            <p class="text-secondary mb-0 leading-relaxed text-justify">
              {{ paper.abstract }}
            </p>
          </div>

          <h6 class="text-uppercase text-muted small fw-bold ls-1 mb-2">Keywords</h6>
          <div class="d-flex flex-wrap gap-2 mb-4">
            <span class="badge bg-secondary-subtle text-secondary fw-normal px-3 py-2">
              {{ paper.keywords || 'None' }}
            </span>
          </div>

          <hr class="text-muted opacity-25 my-4">

          <div class="d-flex align-items-center justify-content-between p-3 border rounded-3 hover-bg-light">
            <div class="d-flex align-items-center">
              <i class="bi bi-file-earmark-pdf-fill text-danger fs-3 me-3"></i>
              <div>
                <h6 class="mb-0 fw-bold">{{ paper.fileName }}</h6>
                <small class="text-muted">Original Submission</small>
              </div>
            </div>
            <button class="btn btn-outline-dark btn-sm rounded-pill">
              <i class="bi bi-download me-1"></i> Download
            </button>
          </div>

        </div>
      </div>
    </div>

    <div class="col-lg-4">

      <div class="card border-0 shadow-sm rounded-4 mb-4">
        <div class="card-body p-4 text-center">
          <h6 class="text-muted text-uppercase small fw-bold mb-3">Current Status</h6>
          <span class="badge px-4 py-2 fs-6 rounded-pill" [ngClass]="getStatusClass(paper.status)">
            {{ paper.status }}
          </span>
          <p class="text-muted small mt-3 mb-0">
            Track ID: <b>#{{ paper.trackId }}</b>
          </p>
        </div>
      </div>

      <div *ngIf="review" class="card border-0 shadow rounded-4 overflow-hidden animate__animated animate__fadeInUp">
        <div class="card-header bg-primary text-white p-3">
          <h6 class="mb-0 fw-bold"><i class="bi bi-chat-quote-fill me-2"></i>Reviewer Feedback</h6>
        </div>
        <div class="card-body p-4 bg-primary-subtle">

          <div class="d-flex justify-content-between align-items-center mb-3">
            <span class="fw-bold text-primary-emphasis">Overall Score</span>
            <span class="badge bg-white text-primary fs-5 border shadow-sm">{{ review.score }} / 100</span>
          </div>

          <div class="mb-3">
            <span class="fw-bold text-primary-emphasis d-block mb-1">Recommendation</span>
            <span class="fw-bold"
                  [ngClass]="{'text-success': review.recommendation === 'Accept', 'text-danger': review.recommendation === 'Reject'}">
              {{ review.recommendation }}
            </span>
          </div>

          <hr class="border-primary opacity-25">

          <h6 class="fw-bold text-primary-emphasis mb-2">Reviewer Comments:</h6>
          <div class="bg-white p-3 rounded-3 border border-primary-subtle text-dark small leading-relaxed">
            {{ review.comments }}
          </div>

        </div>
      </div>

      <div *ngIf="!review" class="card border-0 shadow-sm rounded-4 bg-light text-center py-5 border-dashed">
        <div class="card-body">
          <i class="bi bi-hourglass-split display-4 text-muted opacity-50"></i>
          <h6 class="mt-3 text-muted">Awaiting Review</h6>
          <p class="small text-muted mb-0">Your paper is currently under evaluation.</p>
        </div>
      </div>

    </div>
  </div>
</div>
