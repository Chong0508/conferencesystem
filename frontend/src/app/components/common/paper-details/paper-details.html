<div class="container mt-4 mb-5 animate__animated animate__fadeIn">

  <button class="btn btn-link text-decoration-none text-muted mb-3 ps-0" (click)="goBack()">
    <i class="bi bi-arrow-left me-1"></i> Back to My Submissions
  </button>

  <div *ngIf="isLoading" class="text-center py-5">
    <div class="spinner-border text-primary" role="status"></div>
  </div>

  <div *ngIf="!isLoading && paper" class="row">

    <div class="col-lg-8 mb-4">
      <div class="card border-0 shadow-sm h-100 rounded-4">
        <div class="card-body p-4">

          <div class="d-flex justify-content-between align-items-start mb-3">
            <span class="badge bg-light text-dark border">Paper ID: {{ paperId }}</span>
            <span class="text-muted small">Submitted: {{ paper.submittedAt | date:'medium' }}</span>
          </div>

          <h3 class="fw-bold text-dark mb-4">{{ paper.title }}</h3>

          <h6 class="text-uppercase text-muted small fw-bold ls-1 mb-3">Abstract</h6>
          <div class="p-3 bg-light rounded-3 mb-4 border-start border-4 border-primary">
            <p class="text-secondary mb-0 leading-relaxed text-justify">
              {{ paper.abstract }}
            </p>
          </div>

          <h6 class="text-uppercase text-muted small fw-bold ls-1 mb-2">Keywords</h6>
          <div class="d-flex flex-wrap gap-2 mb-4">
              <span *ngFor="let kw of paper?.keywords" class="badge bg-secondary-subtle text-secondary fw-normal px-3 py-2">
                  {{ kw }}
              </span>
              <span *ngIf="!paper?.keywords || paper.keywords.length === 0" class="badge bg-light text-muted">None</span>
          </div>

          <hr class="text-muted opacity-25 my-4">

          <div class="d-flex align-items-center justify-content-between p-3 border rounded-3 hover-bg-light transition-all shadow-sm">
            <div class="d-flex align-items-center overflow-hidden me-3">
              <i class="bi bi-file-earmark-pdf-fill text-danger fs-3 me-3"></i>
              <div class="text-truncate">
                <h6 class="mb-0 fw-bold text-truncate">{{ getCleanFileName(paper.fileName) }}</h6>
                <small class="text-muted">Original Submission</small>
              </div>
            </div>
            <a [href]="getManuscriptUrl(paper.fileName)" 
               target="_blank" 
               class="btn btn-primary btn-sm rounded-pill px-4 shadow-sm fw-bold">
              <i class="bi bi-eye-fill me-1"></i> View PDF
            </a>
          </div>

        </div>
      </div>
    </div>

    <div class="col-lg-4">

      <div class="card border-0 shadow-sm rounded-4 mb-4">
        <div class="card-body p-4 text-center">
          <h6 class="text-muted text-uppercase small fw-bold mb-3">Current Status</h6>
          <span class="badge px-4 py-2 fs-6 rounded-pill shadow-sm" [ngClass]="getStatusClass(paper.status)">
              {{ paper.status }}
          </span>
          <p class="text-muted small mt-3 mb-0">
            Track ID: <b>#{{ paper.trackId }}</b>
          </p>
        </div>
      </div>

      <div *ngIf="review" class="card border-0 shadow rounded-4 overflow-hidden animate__animated animate__fadeInUp">
        <div class="card-header bg-primary text-white p-3">
          <h6 class="mb-0 fw-bold"><i class="bi bi-chat-quote-fill me-2"></i>Reviewer Feedback</h6>
        </div>
        <div class="card-body p-4 bg-primary-subtle">

          <div class="d-flex justify-content-between align-items-center mb-3">
            <span class="fw-bold text-primary-emphasis">Overall Score</span>
            <span class="badge bg-white text-primary fs-5 border shadow-sm">{{ review.overall_score || review.score }} / 100</span>
          </div>

          <div class="mb-3">
            <span class="fw-bold text-primary-emphasis d-block mb-1">Recommendation</span>
            <span class="fw-bold"
                  [ngClass]="{'text-success': review.recommendation === 'Accept', 'text-danger': review.recommendation === 'Reject', 'text-warning': review.recommendation === 'Revision'}">
                  {{ review.recommendation }}
            </span>
          </div>

          <hr class="border-primary opacity-25">

          <h6 class="fw-bold text-primary-emphasis mb-2">Reviewer Comments:</h6>
          <div class="bg-white p-3 rounded-3 border border-primary-subtle text-dark small leading-relaxed">
            {{ review.comments_to_author || review.comments }}
          </div>

        </div>
      </div>

      <div *ngIf="!review" class="card border-0 shadow-sm rounded-4 bg-light text-center py-5 border-dashed">
        <div class="card-body">
          <i class="bi bi-hourglass-split display-4 text-muted opacity-50"></i>
          <h6 class="mt-3 text-muted fw-bold">Awaiting Review</h6>
          <p class="small text-muted mb-0 px-3">Your paper is currently under evaluation by the technical committee.</p>
        </div>
      </div>

    </div>
  </div>
</div>