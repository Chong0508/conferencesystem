<div class="container mt-4 animate__animated animate__fadeIn">

  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h4 class="fw-bold text-dark mb-1">Paper Master List</h4>
      <p class="text-muted small mb-0">Manage all database submissions and final decisions.</p>
    </div>

    <select class="form-select w-auto shadow-sm" [(ngModel)]="statusFilter" (change)="applyFilter()">
      <option value="All">All Statuses</option>
      <option value="Pending Review">Pending Review</option>
      <option value="Reviewed">Reviewed</option>
      <option value="Accepted">Accepted</option>
      <option value="Rejected">Rejected</option>
      <option value="Registered">Registered</option>
    </select>
  </div>

  <div *ngIf="isLoading" class="text-center py-5">
    <div class="spinner-border text-primary" role="status"></div>
    <p class="text-muted mt-2">Fetching papers from server...</p>
  </div>

  <div *ngIf="!isLoading && filteredPapers.length === 0" class="text-center py-5 bg-white rounded-4 shadow-sm border">
    <i class="bi bi-database-exclamation display-1 text-muted opacity-25"></i>
    <h5 class="mt-3 text-secondary">No Records Found</h5>
    <p class="text-muted small">The database returned no papers for this filter.</p>
  </div>

  <div *ngIf="!isLoading && filteredPapers.length > 0" class="card border-0 shadow-sm rounded-4 overflow-hidden">
    <div class="table-responsive">
      <table class="table table-hover align-middle mb-0">
        <thead class="bg-light">
        <tr>
          <th class="ps-4 py-3">Paper Title & ID</th>
          <th class="py-3">Submitter</th>
          <th class="py-3">Track</th>
          <th class="py-3">Status</th>
          <th class="text-end pe-4 py-3">Management</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let paper of filteredPapers">
          <td class="ps-4">
            <div class="fw-bold text-dark text-truncate" style="max-width: 250px;">{{ paper.title }}</div>
            <small class="text-muted">ID: #{{ paper.paperId }}</small>
          </td>

          <td>
            <div class="text-dark">{{ paper.submitterName || 'Unknown' }}</div>
            <small class="text-muted">Author ID: {{ paper.authorId }}</small>
          </td>

          <td>
            <span class="badge bg-light text-dark border fw-normal">Track {{ paper.trackId }}</span>
          </td>

          <td>
            <span class="badge rounded-pill border px-3 py-2" [ngClass]="getStatusClass(paper.status)">
              {{ paper.status }}
            </span>
          </td>

          <td class="text-end pe-4">
            <div class="btn-group shadow-sm">
              <button class="btn btn-sm btn-white border" (click)="viewDetails(paper.paperId)" title="View Manuscript">
                <i class="bi bi-file-earmark-text text-primary"></i>
              </button>
              
              <button class="btn btn-sm btn-white border" (click)="deletePaper(paper.paperId)" title="Delete from DB">
                <i class="bi bi-trash3 text-danger"></i>
              </button>
            </div>
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>